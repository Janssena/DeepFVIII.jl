\documentclass[border = 0.2cm]{standalone}
\usepackage[utf8]{inputenc}

\usepackage{tikz}
\usepackage{amsfonts, amsmath, amssymb}
\usepackage{systeme, mathtools}
\usetikzlibrary{positioning, arrows.meta, quotes}
\usetikzlibrary{shapes,snakes}
\usetikzlibrary{bayesnet}
% \tikzset{>=latex}
% \tikzstyle{plate caption} = [caption, node distance=0, inner sep=0pt,
% below left=5pt and 0pt of #1.south]
% \tikzset{>={Latex[width=1.5mm,length=1.5mm]}}
\DeclareMathAlphabet      {\mathbfit}{OML}{cmm}{b}{it}
\tikzset{>={Classical TikZ Rightarrow[width=1.5mm, length=1mm, line width=0.2mm]}}
\definecolor{fill_color}{rgb}{0.87, 0.87, 0.87} % lightgrey


\begin{document}
\begin{tikzpicture}
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    % Generative model (figure 1)
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Bloodgroup) at (-2.5, 0) {\textit{\textbf{b}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm, path picture={\fill[fill_color] (path picture bounding box.south) rectangle (path picture bounding box.north west);}] (VWF) at (-1.25, 0) {\textit{\textbf{v}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Age) at (0, 0) {\textit{\textbf{a}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Height) at (1.25, 0) {\textit{\textbf{h}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Weight) at (2.5, 0) {\textit{\textbf{w}}};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Stress) at (-2.5 + 1.25/2, 1.25) {$S$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Comorbidities) at (-1.25/2, 1.25) {$C$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Lifestyle) at (2.5 + 1.25/2, 1.25) {$L$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Diet) at (1.25 + 1.25/2, 1.25) {$D$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Genetics_height) at (1.25, -1.25) {$G_h$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Genetics_VWF) at (-1.25 - 1.25/1.5, -1.25) {$G_v$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Unknown_VWF) at (-1.25, -1.75) {$U_v$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Comedication) at (-1.25/3, -1.25) {$M$};

    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Bloodgroup) -- (VWF);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Genetics_VWF) -- (VWF);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Unknown_VWF) -- (VWF);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Comorbidities) -- (VWF);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Comedication) -- (VWF);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Stress) -- (VWF);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Age) -- (Comorbidities);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Age) -- (Height);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Height) -- (Weight);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Genetics_height) -- (Height);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Diet) -- (Height);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Diet) -- (Weight);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Lifestyle) -- (Weight);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Lifestyle) -- (Diet);

    % \plate[inner sep=.3cm] {plate1} {(Bloodgroup)(Lifestyle)(Stress)(Comedication)} {\normalsize \textbf{\textit{Generative model}}}; %

    % \node[circle, draw=none] at (2.5 + 1.25/2 + 1.35, 0) {\Large \textbf{+}};

    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Weight_pred) at (6, 1.25 / 2.5) {\textit{\textbf{h}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Height_pred) at (6, -1.25 / 2.5) {\textit{\textbf{w}}};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Latent_1) at (6 + 1.25, 1.25 / 2.5) {$U_1$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Latent_2) at (6 + 1.25, -1.25 / 2.5) {$U_2$};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Clearance) at (6 + 1.25 * 2, 1.25 / 2.5) {\textit{CL}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (DistributionVolume) at (6 + 1.25 * 2, -1.25 / 2.5) {$V_1$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (PeriphClearance) at (6 + 1.25 * 4, 1.25 / 2.5) {\textit{Q}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (PeriphDistributionVolume) at (6 + 1.25 * 4, -1.25 / 2.5) {$V_2$};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Inhibitor) at (6 + 1.25 * 3, 1.25) {\textit{I}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Product) at (6 + 1.25 * 3, 0) {\textit{\textbf{p}}};

    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (VWF_pred) at (6 + 1.25 + 1.25 / 2, 1.25 + 1.25 / 4) {\textit{\textbf{v}}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (eta_CL) at (6 + 1.25 * 2 + 1.25 / 3, 1.25 + 1.25 / 3) {$\boldsymbol{\eta}_1$};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (eta_V1) at (6 + 1.25 * 2 - 1.25 / 2, -1.25 - 1.25 / 4) {$\boldsymbol{\eta}_2$};

    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Weight_pred) -- (Latent_1);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Height_pred) -- (Latent_1);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Weight_pred) -- (Latent_2);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Height_pred) -- (Latent_2);
    % \draw[-, line width=0.2mm, shorten >=2, shorten <=2] (Latent_1) -- (Latent_2);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (VWF_pred) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product) -- (Inhibitor);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Inhibitor) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_2) -- (DistributionVolume);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product) -- (DistributionVolume);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product) -- (PeriphClearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product) -- (PeriphDistributionVolume);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (eta_CL) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (eta_V1) -- (DistributionVolume);

    % \plate[inner sep=.3cm] {plate2} {(Weight_pred)(PeriphClearance)(VWF_pred)(eta_V1)} {\normalsize \textbf{\textit{Pharmacokinetic model}}}; 

    % \node[circle, draw=none] at (6 + 1.25 * 4 + 1.35, 0) {\Large \textbf{+}};

    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Center) at (13.85, 0 - 1.25/3) {\textit{\textbf{c}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (AssayType) at (13.85 + 1.25, 1.25 / 2 - 1.25/3) {\textit{\textbf{t}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Reagent) at (13.85 + 1.25, -1.25 / 2 - 1.25/3) {\textit{\textbf{r}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm, path picture={\fill[fill_color] (path picture bounding box.south) rectangle (path picture bounding box.north west);}] (Observation) at (13.85 + 1.25 * 2, 0 - 1.25/3) {\textit{\textbf{y}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Product_F) at (13.85 + 1.25 / 4, 1.25 - 1.25/3) {\textit{\textbf{p}}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Epsilon) at (13.85 + 2.25, 1.25 - 1.25/3) {$\boldsymbol{\epsilon}$};
    
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Center) -- (Reagent);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Center) -- (AssayType);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Center) -- (Product_F);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product_F) -- (AssayType);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Product_F) to [out=280,in=120] (Reagent);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (AssayType) -- (Reagent);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Reagent) -- (Observation);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (AssayType) -- (Epsilon);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (AssayType) -- (Observation);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Epsilon) -- (Observation);

    % \plate[inner sep=.3cm] {plate3} {(Center)(Reagent)(Epsilon)(Observation)} {\normalsize \textbf{\textit{Assay model}}}; 

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Alternative hypotheses

    %%%%% Weight + Height on CL
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Weight_pred) at (6, 1.25 / 2.5) {\textit{\textbf{h}}};
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Height_pred) at (6, -1.25 / 2.5) {\textit{\textbf{w}}};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Latent_1) at (6 + 1.25, 0) {$U_1$};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Clearance) at (6 + 1.25 * 2, 1.25 / 2.5) {\textit{CL}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Volume) at (6 + 1.25 * 2, -1.25 / 2.5) {$V_1$};

    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Weight_pred) -- (Latent_1);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Height_pred) -- (Latent_1);
    
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Volume);

    %%%%% Weight on CL
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Weight_pred) at (6, 0) {\textit{\textbf{w}}};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Latent_1) at (6 + 1.25, 0) {$U_1$};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Clearance) at (6 + 1.25 * 2, 1.25 / 2.5) {\textit{CL}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Volume) at (6 + 1.25 * 2, -1.25 / 2.5) {$V_1$};

    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Weight_pred) -- (Latent_1);
    
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Volume);

    %%%%% Height on CL
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (Height_pred) at (6, 0) {\textit{\textbf{h}}};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Latent_1) at (6 + 1.25, 0) {$U_1$};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Clearance) at (6 + 1.25 * 2, 1.25 / 2.5) {\textit{CL}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Volume) at (6 + 1.25 * 2, -1.25 / 2.5) {$V_1$};

    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Height_pred) -- (Latent_1);
    
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Volume);

    %%%%% FFM on Q (and V2)
    % \node[circle, draw=black, thick, inner sep=0pt, minimum size=0.55cm] (FFM) at (6, 0) {\textit{\textbf{f}}};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Latent_1) at (6 + 1.25, 0) {$U_1$};

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Clearance) at (6 + 1.25 * 2, 1.25 / 2.5) {\textit{Q}};
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (Volume) at (6 + 1.25 * 2, -1.25 / 2.5) {$V_2$};

    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (FFM) -- (Latent_1);
    
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Clearance);
    % \draw[->, line width=0.2mm, shorten >=3, shorten <=3] (Latent_1) -- (Volume);
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    % Model architecture (Supplementary figure 1)
    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (X) at (-1, -1) {\textit{\textbf{X}}};
    
    % \node[circle, draw=black, inner sep=0pt, minimum size=0.55cm] (FFM) at (0, 0.25) {\textit{f}};
    % \draw[->, line width=0.1mm, shorten >=3, shorten <=3] (X) -- (FFM);

    % \draw[draw=none, fill=blue!25] (0.75,-0.75) rectangle ++(0.5,2);
    % \draw[draw=none, fill=blue!25] (1.75,0.5) rectangle ++(0.5,1.5);
    % \draw[draw=none, fill=blue!25] (1.75,-1.5) rectangle ++(0.5,1.5);
    
    % \draw[draw=none, fill=red!25] (0.75,-3.25) rectangle ++(0.5,2);

    % \foreach \i in {1,2,4} {
    %     \node[circle, fill=white, draw=black, inner sep=0pt, minimum size=0.3cm] (ffm_neuron_\i) at (1, 1.5 - 0.5 * \i) {};
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (FFM) -- (ffm_neuron_\i);
    % }
    % \foreach \i in {1,...,3} {
    %     \node[circle, fill=black, inner sep=0pt, minimum size=0.05cm] (dots) at (1, 0.2 - 0.1 * \i) {};
    % }
    % \foreach \i in {1,...,3} {
    %     \node[circle, fill=black, inner sep=0pt, minimum size=0.05cm] (dots) at (1, 0.2 - 0.1 * \i) {};
    % }
    % \foreach \i in {1,3} {
    %     \node[circle, fill=white, draw=black, inner sep=0pt, minimum size=0.3cm] (ffm_neuron_h2_\i) at (2, 2.25 - 0.5 * \i) {};
    %     \node[circle, fill=white, draw=black, inner sep=0pt, minimum size=0.3cm] (ffm_neuron_h3_\i) at (2, 0.25 - 0.5 * \i) {};
    % }
    % \foreach \i in {1,2,4} {
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_\i) -- (ffm_neuron_h2_1);
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_\i) -- (ffm_neuron_h3_1);
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_\i) -- (ffm_neuron_h2_3);
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_\i) -- (ffm_neuron_h3_3);
    % }
    % \foreach \i in {1,...,3} {
    %     \node[circle, fill=black, inner sep=0pt, minimum size=0.05cm] (dots) at (2, 1.45 - 0.1 * \i) {};
    %     \node[circle, fill=black, inner sep=0pt, minimum size=0.05cm] (dots) at (2, -0.55 - 0.1 * \i) {};
    % }
    % \node[circle, draw=black, inner sep=0pt, minimum size=0.4cm] (ffm_neuron_eff_cl) at (3, 1.25) {\footnotesize a};
    % \node[circle, draw=black, inner sep=0pt, minimum size=0.4cm] (ffm_neuron_eff_v1) at (3, -0.75) {\footnotesize b};
    % \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_h2_1) -- (ffm_neuron_eff_cl);
    % \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_h2_3) -- (ffm_neuron_eff_cl);
    % \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_h3_1) -- (ffm_neuron_eff_v1);
    % \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (ffm_neuron_h3_3) -- (ffm_neuron_eff_v1);

    % \node[circle, draw=black, inner sep=0pt, minimum size=0.55cm] (VWF) at (0, -2.25) {\textit{v}};
    % \draw[->, line width=0.1mm, shorten >=3, shorten <=3] (X) -- (VWF);
    % \node[circle, draw=black, inner sep=0pt, minimum size=0.4cm] (vwf_neuron_eff) at (2, -2.25) {\footnotesize c};
    % \foreach \i in {1,2,4} {
    %     \node[circle, fill=white, draw=black, inner sep=0pt, minimum size=0.3cm] (vwf_neuron_\i) at (1, -1 - 0.5 * \i) {};
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (VWF) -- (vwf_neuron_\i);
    %     \draw[-, line width=0.1mm, shorten >=3, shorten <=3] (vwf_neuron_\i) -- (vwf_neuron_eff);
    % }
    % \foreach \i in {1,...,3} {
    %     \node[circle, fill=black, inner sep=0pt, minimum size=0.05cm] (dot) at (1, -2.3 - 0.1 * \i) {};
    % }

    % \node[circle, draw=none, inner sep=0pt, minimum size=0.55cm] (zeta) at (4.75, 1) {\footnotesize $\zeta = \begin{bmatrix} \mathrm{a} \cdot \mathrm{c} \\ \mathrm{b} \\ \theta_1 \\ \theta_2 \end{bmatrix}$};
    % \node[rectangle, draw=none, inner sep=5pt] (fake) at (5, 0.5) {};
    % \node[rectangle, draw=black, inner sep=5pt] (ode) at (5, -1.1) {ODE};
    % \node[circle, draw=none, inner sep=5pt] (output) at (5, -2.75) {\textbf{\textit{Y}}};
    % \draw[->, line width=0.1mm, shorten >=1, shorten <=6] (ode) -- (output);
    % \draw[->, line width=0.1mm, shorten >=6, shorten <=6] (fake) -- (ode);

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{tikzpicture}
\end{document}